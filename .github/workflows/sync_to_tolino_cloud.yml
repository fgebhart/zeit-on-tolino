
name: Periodic Sync

on:
  schedule:
      # equals each Wednesday at 22:08 CEST (to avoid high load on github actions at the full hour)
    - cron: '8 20 * * WED'


jobs:
  test:
    name: Zeit to Tolino Cloud
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Set up Python 3.10
      uses: actions/setup-python@v2
      with:
        python-version: "3.10"

    - name: Install Poetry
      uses: snok/install-poetry@v1
      with:
        virtualenvs-create: true
        virtualenvs-in-project: true
        installer-parallel: true

    - name: Run Zeit-on-Tolino Script
      env:
        ZEIT_PREMIUM_USER: ${{ secrets.ZEIT_PREMIUM_USER }}
        ZEIT_PREMIUM_PASSWORD: ${{ secrets.ZEIT_PREMIUM_PASSWORD }}
        TOLINO_USER: ${{ secrets.TOLINO_USER }}
        TOLINO_PASSWORD: ${{ secrets.TOLINO_PASSWORD }}
        TOLINO_PARTNER_SHOP: ${{ secrets.TOLINO_PARTNER_SHOP }}
      run: poetry run python sync.py
